def train_step(real_x, real_y):
  with tf.GradientTape(persistent=True) as tape:
      fake_y = generator_g(real_x, training=True)
      cycled_x = generator_f(fake_y, training=True)

      fake_x = generator_f(real_y, training=True)
      cycled_y = generator_g(fake_x, training=True)

      same_x = generator_f(real_x, training=True)
      same_y = generator_g(real_y, training=True)

      disc_real_x = discriminator_x(real_x, training=True)
      disc_real_y = discriminator_y(real_y, training=True)
      disc_fake_x = discriminator_x(fake_x, training=True)
      disc_fake_y = discriminator_y(fake_y, training=True)

      total_gen_g_loss = generator_loss(real_x, real_y, cycled_x, cycled_y, disc_fake_y, same_y)
      total_gen_f_loss = generator_loss(real_x, real_y, cycled_x, cycled_y, disc_fake_x, same_x)

      disc_x_loss = discriminator_loss(disc_real_x, disc_fake_x)
      disc_y_loss = discriminator_loss(disc_real_y, disc_fake_y)